{% extends "layout.html" %}
{% set active_page = "clientWork" %}

{% block body %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
  <h1 class="h2">稼働情報</h1>
  <div class="btn-toolbar mb-2 mb-md-0">
    <button class="btn btn-sm btn-outline-secondary mr-2" onclick="createWorkTime()"><span data-feather="file-plus"></span> 新規作成</button>
  </div>
</div>

    <table id="example" class="table table-striped table-bordered display nowrap" style="width:100%">
        <thead>
            <tr>
                <th data-priority="1">稼働時間</th>
                <th data-priority="2">オーダー</th>
                <th>タスク</th>
                <th>サブオーダー</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    
    
    <script>
    
    function createWorkTime(){
        location.href = "{{ url_for('clientWork.clinent_work_details', month=month, day=day, travelExpensesId=0) }}";
    }

    $(function() {
        var table = $('#example').DataTable( {
            responsive: true,
            "columnDefs": [
            { responsivePriority: 1, targets: 0 },
            { responsivePriority: 2, targets: 1 }
              ],
            ajax: {
                type   : "POST",
                url    : "{{ url_for('clientWork.clinent_work_list', month=month, day=day) }}",
                contentType: 'application/json',
                dataType : 'JSON',
                scriptCharset: 'utf-8',
                data   : function( d ) {
                  d.name= $('#name').val();
                  return JSON.stringify(d);
                },
                "dataSrc": ""
            },
            'columns': [
                        {"data" : "workTime",
                            "fnCreatedCell": function (nTd, sData, oData, iRow, iCol) {
                                $(nTd).html("<a href='/clientWork/{{ month }}/"+oData.travelExpensesId+"'>"+oData.expenseDate+"</a>");
                            }},
                        {"data" : "orderCd"},
                        {"data" : "taskCd"},
                        {"data" : "subOrderCd"}
            ],
            language: {
              emptyTable: "該当するデータが見つかりませんでした。",
              info: "_TOTAL_ 件中 _START_ 件から _END_ 件までを表示",
              infoEmpty: "",
              infoFiltered: "(_MAX_ 件からの絞り込み表示)",
              infoPostFix: "",
              thousands: ",",
              lengthMenu: "表示件数: _MENU_",
              loadingRecords: "ロード中",
              processing: "処理中...",
              search: "一覧表示内絞込検索",
              zeroRecords: "該当するデータが見つかりませんでした。",
              paginate: {
                first: "先頭",
                previous: "前へ",
                next: "次へ",
                last: "末尾"
              }
            }
        } );
        window.test = function(){
            alert('ajax test');
            table.ajax.reload();
    };
    } );
    </script> 
  <!-- dataTables core JavaScript -->
  <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
{% endblock %}