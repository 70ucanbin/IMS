{% extends "layout.html" %}

{% block body %}
  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
      <h1 class="h2">旅費精算</h1>
      <div class="btn-toolbar mb-2 mb-md-0">
        <button class="btn btn-sm btn-outline-secondary mr-2" onclick="createTravelExpenses()"><span data-feather="file-plus"></span> 新規作成</button>
        <button class="btn btn-sm btn-outline-secondary mr-2" onclick="downloadTravelExpenses()"><span data-feather="download"></span> 詳細出力</button>
        <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button"  data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <span data-feather="calendar"></span>
          {{ month }}月
        </button>
        <div class="dropdown-menu text-center">
            <a class="dropdown-item" id="testbtn" onclick="test()" href="#"}>1月</a>
            <a class="dropdown-item" href="{{ url_for('travelExpenses.travel_expenses_list', month=2) }}">2月</a>
            <a class="dropdown-item" href="{{ url_for('travelExpenses.travel_expenses_list', month=3) }}">3月</a>
            <a class="dropdown-item" href="{{ url_for('travelExpenses.travel_expenses_list', month=4) }}">4月</a>
            <a class="dropdown-item" href="{{ url_for('travelExpenses.travel_expenses_list', month=5) }}">5月</a>
            <a class="dropdown-item" href="{{ url_for('travelExpenses.travel_expenses_list', month=6) }}">6月</a>
            <a class="dropdown-item" href="{{ url_for('travelExpenses.travel_expenses_list', month=7) }}">7月</a>
            <a class="dropdown-item" href="{{ url_for('travelExpenses.travel_expenses_list', month=8) }}">8月</a>
            <a class="dropdown-item" href="{{ url_for('travelExpenses.travel_expenses_list', month=9) }}">9月</a>
            <a class="dropdown-item" href="{{ url_for('travelExpenses.travel_expenses_list', month=10) }}">10月</a>
            <a class="dropdown-item" href="{{ url_for('travelExpenses.travel_expenses_list', month=11) }}">11月</a>
            <a class="dropdown-item" href="{{ url_for('travelExpenses.travel_expenses_list', month=12) }}">12月</a>
        </div>
      </div>
  </div>

      <table id="example" class="table table-striped table-bordered display nowrap" style="width:100%">
          <thead>
              <tr>
                  <th data-priority="1">月日</th>
                  <th data-priority="2">費目</th>
                  <th>ルート</th>
                  <th>交通手段</th>
                  <th data-priority="3">金額</th>
                  <th>添付</th>
              </tr>
          </thead>
          <tbody>
              <tr>
                  <td>2019/8/31</td>
                  <td>定期</td>
                  <td>月～地球</td>
                  <td>ロケット</td>
                  <td>999,999,999</td>
                  <td><span data-feather="check"></span></td>
              </tr>
              <tr>
                  <td>2019/8/31</td>
                  <td>出張</td>
                  <td>地球～火星</td>
                  <td>宇宙船</td>
                  <td>999,999,999</td>
                  <td></td>
              </tr>
              <tr>
                  <td>2019/8/31</td>
                  <td>研究教育</td>
                  <td>サーバー部品1</td>
                  <td></td>
                  <td>999,999,999</td>
                  <td><span data-feather="check"></span></td>
              </tr>
              <tr>
                  <td>2019/8/31</td>
                  <td>研究教育</td>
                  <td>サーバー部品2</td>
                  <td></td>
                  <td>999,999,999</td>
                  <td><span data-feather="check"></span></td>
              </tr>
              <tr>
                  <td>2019/8/31</td>
                  <td>研究教育</td>
                  <td>サーバー部品3</td>
                  <td></td>
                  <td>999,999,999</td>
                  <td><span data-feather="check"></span></td>
              </tr>
      
          </tbody>
      </table>
      
      
      <script>
      
      function createTravelExpenses(){
          location.href = "{{ url_for('travelExpenses.travel_expenses_details', month=month, travelExpensesId=0) }}";
      }
      
      function downloadTravelExpenses(){
          location.href = "#";
      }
      
      $(document).ready(function() {
          var table = $('#example').DataTable( {
              responsive: true,
              "columnDefs": [
              { responsivePriority: 1, targets: 0 },
              { responsivePriority: 2, targets: 1 },
              { responsivePriority: 3, targets: 4 }
                ],
              ajax: {
                  type   : "POST",
                  url    : "{{ url_for('travelExpenses.travel_expenses_list', month=month) }}",
                  contentType: 'application/json',
                  dataType : 'JSON',
                  scriptCharset: 'utf-8',
                  data   : function( d ) {
                    d.name= $('#name').val();
                    return JSON.stringify(d);
                  },
                  "dataSrc": ""
              },
              'columns': [
                          {"data" : "name"},
                          {"data" : "position"},
                          {"data" : "salary"},
                          {"data" : "start_date"},
                          {"data" : "office"},
                          {"data" : "extn"}
              ],
              language: {
                emptyTable: "該当するデータが見つかりませんでした。",
                info: "_TOTAL_ 件中 _START_ 件から _END_ 件までを表示",
                infoEmpty: "",
                infoFiltered: "(_MAX_ 件からの絞り込み表示)",
                infoPostFix: "",
                thousands: ",",
                lengthMenu: "表示件数: _MENU_",
                loadingRecords: "ロード中",
                processing: "処理中...",
                search: "一覧表示内絞込検索",
                zeroRecords: "該当するデータが見つかりませんでした。",
                paginate: {
                  first: "先頭",
                  previous: "前へ",
                  next: "次へ",
                  last: "末尾"
                }}
          } );
          window.test = function(){
              alert('ajax test');
              table.ajax.reload();
      };
      } );
      </script> 
    <!-- dataTables core JavaScript -->
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
{% endblock %}